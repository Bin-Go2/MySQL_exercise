## 1211. Queries Quality and Percentage(Easy)

requirement: find each query_name, the quality and poor_query_percentage.

example:

table name : Queries

| query_name | result            | position | rating |
|------------|-------------------|----------|--------|
| Dog        | Golden Retriever  | 1        | 5      |
| Dog        | German Shepherd   | 2        | 5      |
| Dog        | Mule              | 200      | 1      |
| Cat        | Shirazi           | 5        | 2      |
| Cat        | Siamese           | 3        | 3      |
| Cat        | Sphynx            | 7        | 4      |


=>

| query_name | quality | poor_query_percentage |
|------------|---------|-----------------------|
| Dog        | 2.50    | 33.33                 |
| Cat        | 0.66    | 33.33                 |


### solution:

```
SELECT query_name,
ROUND(AVG(rating/position),2) AS quality,
ROUND(SUM(CASE WHEN rating<3 THEN 1 ELSE 0 END)/COUNT(query_name)*100,2) AS poor_query_percentage
FROM Queries 
GROUP BY query_name;

```

